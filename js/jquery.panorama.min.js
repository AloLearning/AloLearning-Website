(function(a) {
    function b(b, d) {
        var j, k, l, n, o, p, q, r, w, y, B, f = jQuery.extend({}, {
                size: !1,
                speed: 10,
                move: 200,
                gravity: 400,
                wheel: 1,
                drag: 1,
                attenuation: 4,
                fade: 400,
                fps: 60
            }, d),
            g = 0,
            h = 0,
            m = 0,
            s = !1,
            t = !1,
            u = -1,
            v = -1,
            x = !1,
            z = null,
            C = !0;
        Date.now === void 0 && (Date.now = function() {
            return (new Date).getTime()
        });
        var G = Date.now(),
            H = function() {
                q = !1, o = Array();
                var c = b.css("backgroundImage"),
                    d = b.find(".panorama_titel").css("position", "relative").remove(),
                    e = b.find(".panorama_preloader").css("position", "relative").remove();
                d.find("img").bind("dragstart", function(a) {
                    a.preventDefault()
                }), b.find("img").each(function() {
                    this.src ? (o.push({
                        path: this.src
                    }), this.src = "") : a(this).data("src") && o.push({
                        path: a(this).data("src")
                    })
                }), ab(), b.css({
                    overflow: "hidden",
                    position: "relative",
                    padding: "0px",
                    backgroundImage: "none"
                }), f.size === !0 && b.css({
                    position: "fixed",
                    margin: "0px",
                    width: "100%",
                    top: "0px",
                    left: "0px"
                }), n = a("<div></div>").css({
                    overflow: "hidden",
                    top: "0px",
                    left: "0px",
                    position: "absolute",
                    padding: "0px",
                    margin: "0px"
                }), b.empty().append(n, e), a('<div class="panorama_pattern"></div>').css({
                    width: "100%",
                    height: "100%",
                    "background-image": c,
                    position: "absolute",
                    top: "0px",
                    left: "0px",
                    padding: "0px",
                    margin: "0px"
                }).appendTo(b), b.append(d), z = "ontouchstart" in document.documentElement ? !0 : !1, z && (f.fade = !1), bb(), r = g, eb(), a(window).resize(function() {
                    K(!1), R(), clearTimeout(w), w = setTimeout(I, 100)
                }), I(), q = !0
            },
            I = function() {
                if (f.size === !0) {
                    var c = 2 * parseFloat(b.css("borderWidth"));
                    (isNaN(c) || !c) && (c = 0), l = a(window).height() - c, k = a(window).width() - c, b.height(l), b.width(k), X()
                } else if (0 > f.size) {
                    k = b.width();
                    var d = -f.size;
                    l != d && (l = d, b.height(l), X())
                } else if (f.size > 0) {
                    k = b.width();
                    var d = k / f.size;
                    l != d && (l = d, b.height(l), X())
                } else k = b.width();
                T(1, !1), q && (K(), Q())
            },
            J = function() {
                z ? (b.unbind("touchstart touchend touchmove", M), (f.drag || f.move) && b.bind("touchstart touchend touchmove", M), K()) : (b.unbind("mousedown mouseup mouseleave mousemove mousewheel DOMMouseScroll MozMousePixelScroll wheel scroll", M), f.drag && b.bind("mousedown", M), f.wheel && b.bind("mousewheel DOMMouseScroll MozMousePixelScroll wheel", M), (f.move || f.drag) && (b.bind("mousemove mouseleave", M), L(!0)))
            },
            K = function(a) {
                var b = !1;
                window.DeviceOrientationEvent ? b = "deviceorientation" : window.OrientationEvent && (b = "MozOrientation"), b && (window.removeEventListener(b, M, !1), f.gravity && a !== !1 && window.addEventListener(b, M, !1))
            },
            L = function(a) {
                document.addEventListener ? a ? document.addEventListener("mouseout", M, !1) : document.removeEventListener("mouseout", M, !1) : document.attachEvent && (a ? document.attachEvent("onmouseout", M) : document.detachEvent("onmouseout", M))
            },
            M = function(c) {
                switch (c = c ? c : window.event, c.type) {
                    case "mousemove":
                        var d = Date.now();
                        if (G + B > d && !x) return;
                    case "touchmove":
                        C = !1;
                        var e = N(c);
                        if (x) g = (e - y) * f.drag, y = e, (f.drag && "mousemove" == c.type || "touchmove" == c.type) && P(g, !0) && Y();
                        else if (f.move) {
                            var h = a("html").scrollLeft();
                            h || (h = a("body").scrollLeft()), e += -b.offset().left + h, r = (2 * e / k - 1) * f.move / f.fps, Q()
                        }
                        cb(g), G = d;
                        break;
                    case "mousewheel":
                    case "MozMousePixelScroll":
                    case "wheel":
                    case "DOMMouseScroll":
                        c.detail || c.wheelDelta || (c = c.originalEvent);
                        var i = c.wheelDelta || -c.detail;
                        if (!i) break;
                        i = Math.abs(f.wheel) * (f.wheel * i > 0 ? 1e3 : -1e3) / f.fps, g * i > 0 ? g += i / 3 : g = i / 3, g = V(g, 1e3 * Math.abs(f.wheel) / f.fps), r = (g > 0 ? 1 : -1) * Math.abs(f.speed) / f.fps, G = Date.now() + 1e3, C = !0, Q(), c.preventDefault && c.preventDefault(), c.returnValue = !1;
                        break;
                    case "touchstart":
                    case "mousedown":
                        g = 0, r = 0, R(), x = !0, y = N(c), "mousedown" == c.type && b.unbind("mouseup mousemove", M).bind("mouseup mousemove", M).css("cursor", "move"), G = Date.now() - 500;
                        break;
                    case "mouseout":
                    case "onmouseout":
                        var j = c.relatedTarget || c.toElement;
                        if (j && "HTML" != j.nodeName) return;
                    case "mouseleave":
                        r = (g > 0 ? 1 : -1) * Math.abs(f.speed) / f.fps;
                    case "touchend":
                    case "mouseup":
                        ("mouseup" == c.type || "mouseleave" == c.type) && (b.unbind("mouseup mousemove", M).css("cursor", "auto"), f.move && b.bind("mousemove", M)), x = !1, C = !0, 0 != g ? Q() : "mouseup" == c.type && (r = g), ("mouseup" == c.type || "touchend" == c.type) && (G = Date.now() + 1e3);
                        break;
                    case "MozOrientation":
                        c.gamma = 90 * eventData.x, c.beta = 90 * -eventData.y;
                    case "deviceorientation":
                        if (G + 3 * B > Date.now() || x) return;
                        C = !1;
                        var e = 0;
                        switch (window.orientation) {
                            case 90:
                                e = Math.max(-.5, Math.min(.5, c.beta / 90));
                                break;
                            case -90:
                                e = -Math.max(-.5, Math.min(.5, c.beta / 90));
                                break;
                            case 180:
                                e = Math.max(-.5, Math.min(.5, c.gamma / 90));
                                break;
                            case 0:
                            default:
                                (-90 > c.gamma || c.gamma > 90) && (c.gamma = Math.abs(c.gamma) / c.gamma * (180 - Math.abs(c.gamma))), e = Math.max(-45, Math.min(45, c.gamma)) / 90
                        }
                        if (.033 > Math.abs(e)) return C = !0, r = g, 0 == g && R(), void 0;
                        r = 2 * e * f.gravity / f.fps, Q(), G = Date.now()
                }
            },
            N = function(a) {
                if (z) {
                    "touchstart" != a.type && a.preventDefault();
                    var b = a.originalEvent.touches[0] || a.originalEvent.changedTouches[0];
                    return b.pageX
                }
                return a.clientX
            },
            O = function() {
                k = b.width();
                var a = Math.abs(g) * f.fps;
                if (1 > a && g == r && (g = 0, r = 0, R()), C) {
                    var c = Math.abs(f.speed);
                    a != c ? (g *= 1 + (c > a ? 1 : -1) * f.attenuation / f.fps, (c > a && f.fps * Math.abs(g) > c || a > c && c > f.fps * Math.abs(g)) && (g = V(g, c / f.fps), C = !1), cb(g)) : C = !1
                } else g != r && (g -= Math.min(1, 8 / f.fps) * (g - r), 1 > Math.abs(g - r) * f.fps && (g = r));
                P(g, !0) && Y()
            },
            P = function(a, b) {
                if (t) {
                    if (b) {
                        if (a += h, h = a - Math.round(a), 1 > Math.abs(Math.round(a))) return !1;
                        var c = n[0].style.left;
                        a += parseFloat(c)
                    }
                    return n[0].style.left = Math.round(a) + "px", !0
                }
            },
            Q = function() {
                S(), -1 == u && (u = setInterval(O, B))
            },
            R = function() {
                clearInterval(u), u = -1
            },
            S = function() {
                -1 != v && (clearTimeout(v), v = -1)
            },
            T = function(c, d) {
                if (!p) {
                    if (0 == o.length) return R(), void 0;
                    var e = 0;
                    if (c > 0) {
                        if (parseFloat(n[0].style.left) + m - k > j) return;
                        n[0].lastChild && (e = a(n[0].lastChild).data("index"), e = U(e, 1))
                    } else {
                        if (-parseFloat(n[0].style.left) > j) return;
                        n[0].firstChild && (e = a(n[0].firstChild).data("index"), e = U(e, -1))
                    }
                    if (o[e].img) {
                        var g = o[e].img.clone(!0).attr("src", o[e].path);
                        return c > 0 ? n.append(g) : n.prepend(g), f.size ? X(g[0]) : (m += g[0].width, n.width(m)), 0 > c && P(-g[0].width, !0), Z(g, d, c), T(c, d), void 0
                    }
                    var g = a("<img>").bind("dragstart", function(a) {
                        a.preventDefault()
                    }).css({
                        "float": "left",
                        padding: "0px",
                        margin: "0px",
                        "vertical-align": "top",
                        top: "0px"
                    }).data("index", e);
                    o[e].img = g.clone(!0), p = !0, g.error(function() {
                        o.splice(e, 1), p = !1, T(c, d)
                    }).one("load", function() {
                        var e = a(this);
                        c > 0 ? n.append(e) : n.prepend(e), X(this), Z(e, d, c), 0 > c && P(-this.width, !0), s || (b.find(".panorama_preloader").remove(), s = !0, J(), Q()), p = !1, T(c, d)
                    }).attr("src", o[e].path).each(function() {
                        var b = a(this);
                        this.complete && this.width > 0 && this.height > 0 && b.trigger("load")
                    })
                }
            },
            U = function(a, b) {
                return b > 0 ? a >= o.length - 1 ? 0 : a + 1 : 0 >= a ? o.length - 1 : a - 1
            },
            V = function(a, b) {
                return Math.abs(a) > Math.abs(b) && (a = (0 > a ? -1 : 1) * b), a
            },
            W = function() {
                var a = 0;
                return n.children("img").each(function() {
                    a += this.width
                }), a
            },
            X = function(c) {
                if (f.size) {
                    if (!l) return;
                    if (c === void 0) {
                        var d = n.find("img");
                        m = 0
                    } else var d = a(c);
                    if (!d.length) return;
                    var e = 1;
                    if (d.each(function() {
                            if (this.height) {
                                var a = l / this.height;
                                e = Math.min(e, a), this.width = this.width * a, m += this.width
                            }
                        }), c === void 0) {
                        var g = parseInt(n[0].style.left) * e;
                        P(g, !1)
                    }
                    return n.width(m), void 0
                }
                return l === void 0 ? (l = c.height, c !== void 0 && (m += c.width, n.width(m)), b.height(l), void 0) : (l = Math.min(l, c.height), b.height() != l && b.animate({
                    height: l
                }, 300), void 0)
            },
            Y = function() {
                var b = parseFloat(n[0].style.left);
                if (0 > g) {
                    var c = n[0].firstChild; - b > c.width && (P(c.width, !0), a(c).remove(), m = W(), n.width(m)), j > b + m - k && T(1, !1)
                } else if (g > 0) {
                    var d = n[0].lastChild;
                    b - d.width + m > k && (a(d).remove(), m = W(), n.width(m)), j > -b && T(-1, !1)
                }
            },
            Z = function(a, b, c) {
                b || 0 >= f.fade || !$(a[0], c) ? a.show() : a.hide().fadeIn(f.fade, function() {
                    "obgect" == typeof jQuery.browser && jQuery.browser.msie && a[0].style.removeAttribute("filter")
                })
            },
            $ = function(a, b) {
                var c = m - a.width,
                    d = parseInt(n[0].style.left);
                return d + c > k ? !1 : b > 0 ? !0 : 0 > d + a.width ? !1 : !0
            },
            _ = function(a) {
                if ("string" == typeof a) {
                    var b = a.toLowerCase();
                    return b == "false" + "" || b == "no" + "" ? !1 : b == "true" + "" || b == "fullscreen" + "" ? !0 : -1 === b.indexOf("px") ? !1 : (b = parseInt(b), isNaN(b) ? !1 : -b)
                }
                var c = parseFloat(a);
                return 0 == isNaN(c) ? c : a
            },
            ab = function() {
                for (var a in f) f[a] = _(f[a]);
                1 > f.fps && (f.fps = 1), 0 > f.fadein && (f.fadein = 0), 0 > f.attenuation && (f.attenuation = 0), "string" == typeof f.size ? f.size = !1 : f.size !== !0 && f.size !== !1 && (f.size = 0 == f.size ? !1 : f.size)
            },
            bb = function() {
                B = Math.round(1e3 / f.fps), g = -f.speed / f.fps, cb(f.speed)
            },
            cb = function(a) {
                j = Math.max(200, Math.abs(2 * a))
            },
            eb = function() {
                var b = a("#c");
                1 == b.length && b[0].href && (t = "%68%74%74%70%3a%2f%2f%63%6f%64%65%63%61%6e%79%6f%6e%2e%6e%65%74%2f%75%73%65%72%2f%53%61%6e%64%69%2f%70%6f%72%74%66%6f%6c%69%6f%3f%72%65%66%3d%73%61%6e%64%69" == fb(b[0].href))
            },
            fb = function(a) {
                var b = "";
                for (var c in a)
                    for (c = a.charAt(c), i = 0; 256 > i; ++i) {
                        var d = i.toString(16);
                        if (1 == d.length && (d = "0" + d), d = "%" + d, unescape(d) == c) {
                            b += d;
                            break
                        }
                    }
                return b
            };
        this.option = function(a, c) {
            if (a !== void 0) {
                if (a = a.replace(/^\s+|\s+$/g, ""), f[a] === void 0) return b;
                if (c === void 0) return f[a];
                var d = f[a];
                if ("string" == typeof c ? (c = c.replace(/^\s+|\s+$/g, ""), f[a] = _(c)) : ("boolean" == typeof c || "number" == typeof c || "function" == typeof c) && (f[a] = c), d === f[a] || "size" == a) return;
                ab(), "fps" == a || "speed" == a ? (bb(), "speed" == a && (r = g), R(), Q()) : "move" == a || "wheel" == a || "drag" == a ? J() : "gravity" == a && K()
            }
        }, this.pause = function(a) {
            -1 != u && (R(), a > 0 && (S(), v = setTimeout(Q, a)))
        }, this.play = function(a) {
            isNaN(parseFloat(a)) || (a = parseFloat(a), g = -a / f.fps, cb(a), r = (g > 0 ? 1 : -1) * Math.abs(r)), C = !0, Q()
        }, this.destroy = function() {
            R(), b.find("img").unbind().removeData(), b.unbind(), L(!1), K(!1), a(window).unbind("scroll", M), b.images_settings = null, b.removeData(c)
        }, H()
    }
    var c = "panorama";
    a.fn[c] = function(d) {
        if (0 == this.length) return !1;
        var e = arguments[0];
        if ("string" == typeof e) {
            var f = a(this),
                g = f.data(c);
            if ("function" == typeof g[d]) {
                var h = Array.prototype.slice.call(arguments, 1);
                return g[d].apply(f[0], h)
            }
        } else if ("object" == typeof d || !d) return this.each(function() {
            var e = a(this);
            return e.data(c), "object" != typeof d && d ? void 0 : e.data(c, new b(e, d))
        })
    }
})(jQuery);